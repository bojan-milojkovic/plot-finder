<html>
	<head>
		<title>From Info Windows to a Database: Saving User-Added Form Data</title>
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    
		<style>
		  #map {
			height: 100%;
		  }
		  /* Optional: Makes the sample page fill the window. */
		  html, body {
			height: 100%;
			margin: 0;
			padding: 0;
		  }
		</style>
		
		<script type = "text/javascript" src = "https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	</head>
	<body>
	<div id="map" height="460px" width="100%"></div>
	
	<div id="form">
		<table>
			<tr><td>Name:</td> <td><input type='text' id='name'/> </td> </tr>
			<tr><td>Address:</td> <td><input type='text' id='address'/> </td> </tr>
			<tr><td>Type:</td> 
				<td><select id='type'> +
					<option value='bar' SELECTED>bar</option>
					<option value='restaurant'>restaurant</option>
					</select> </td>
			</tr>
			<tr><td></td><td><input type='button' value='Save' onclick='saveData()'/></td></tr>
		</table>
	</div>
	
	<div id = "message">Location saved</div>
	
	<script>
		var map;
		var marker;
		var infowindow;
		var messagewindow;
		
		function initMap(){
			var california = {lat: 37.4419, lng: -122.1419};
			map = new google.maps.Map(document.getElementById('map'),
				{
					center: california,
					zoom : 13
				}
			);
			
			infowindow = new google.maps.InfoWindow({
				content : document.getElementById('form')
			});
			
			messagewindow = new google.maps.InfoWindow({
				content : document.getElementById('message')
			});
			
			google.maps.event.addListener(map, 'click', function(event){
				marker = new google.maps.Marker({
					position : event.latLng,
					map : map
				});
				
				google.maps.event.addListener(marker, 'click', function(){
					infowindow.open(map, marker);
				});
			});
		}
		
		function saveData(){
			var url = 'localhost:8080/.......';
			
			$.post(
				url,
				{
					name : escape(document.getElementById('name').value),
					address : escape(document.getElementById('name').value),
					type : document.getElementById('type').value,
					lat : marker.getPosition().lat(),
					lng : marker.getPosition().lng()
				},
				function(data, status){
					
				}
			);
			/*downloadUrl(url, function(data, responseCode){
				if(responseCode == 200 && data.length <=1){
					infowindow.close();
					messagewindow.open(map,marker);
				}
			});*/
		}
		
		/*function downloadUrl(url, callback){
			var request = window.ActiveXObject ?
					new ActiveXObject('Microsoft.XMLHTTP') :
					new XMLHttpRequest;
					
				request.onreadystatechange = function(){
					if(request.readyState == 4){
						request.onreadystatechange = doNothing;
						callback(request.responseText, request.status);
					}
				};
				
				request.open('GET', url, true);
				request.send(null);
		}
		
		function doNothing(){}*/
	</script>
	
	<script src="https://maps.googleapis.com/maps/api/js?v=quarterly&key=AIzaSyAnUcOUuCwexpeI5wIAZMkpK5LRYDAajgk&callback=initMap"
	async defer></script>
	</body>
</html>